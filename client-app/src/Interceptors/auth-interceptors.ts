import {
  HttpInterceptor,
  HttpRequest,
  HttpHandler,
  HttpEvent,
} from "@angular/common/http";
import { Injectable } from "@angular/core";
import { Observable } from "rxjs";
import { Router } from "@angular/router";
import { environment } from "../environments/environment";

@Injectable()
export class AuthInterceptor implements HttpInterceptor {

  accessToken: string;
  userId: string;
  access_token: string;
  user_id: string;

  constructor(public _router: Router) {
    if (environment.name === 'beta') {
      this.accessToken = "eyJ0eXAiOiJKV1QiLCJub25jZSI6IkpXaW1udzBMbTVJU1NESDVCWGdVekRfWnl5eUdQVjRmQ0ZZVDNJMVlaWFkiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8yZmQwODA1Zi1mNjFmLTQ5NzgtODkzNi1hODlkMTc3MTczYmYvIiwiaWF0IjoxNjE3MTkxOTM5LCJuYmYiOjE2MTcxOTE5MzksImV4cCI6MTYxNzE5NTgzOSwiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsidXJuOnVzZXI6cmVnaXN0ZXJzZWN1cml0eWluZm8iLCJ1cm46bWljcm9zb2Z0OnJlcTEiLCJ1cm46bWljcm9zb2Z0OnJlcTIiLCJ1cm46bWljcm9zb2Z0OnJlcTMiLCJjMSIsImMyIiwiYzMiLCJjNCIsImM1IiwiYzYiLCJjNyIsImM4IiwiYzkiLCJjMTAiLCJjMTEiLCJjMTIiLCJjMTMiLCJjMTQiLCJjMTUiLCJjMTYiLCJjMTciLCJjMTgiLCJjMTkiLCJjMjAiLCJjMjEiLCJjMjIiLCJjMjMiLCJjMjQiLCJjMjUiXSwiYWlvIjoiQVVRQXUvOFRBQUFBczYwY3dxM3BRZmx0d29qUXp1a29oK2xNd2ZqVDh4bmlTRGc1ZFJrY3JIVjdYY1U2SExGTzN4NXRRSm9YMDlnclJOQ0lyMm5VSEdCTWJZcVp0QVdxN3c9PSIsImFtciI6WyJwd2QiLCJtZmEiXSwiYXBwX2Rpc3BsYXluYW1lIjoiQVItQ01TLUFQUC1CRVRBLTAxICIsImFwcGlkIjoiYTFmMjliMDAtMDE4Yi00NTE3LWI1ZmYtZTY0ZDA5ZDFkZjE4IiwiYXBwaWRhY3IiOiIxIiwiZmFtaWx5X25hbWUiOiJWZWVyYXNhbXkiLCJnaXZlbl9uYW1lIjoiQW5hbmRoYWJhYnUiLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiIxMDYuMjIyLjExMi4yMjAiLCJuYW1lIjoiQW5hbmRoYWJhYnUgVmVlcmFzYW15Iiwib2lkIjoiNGU4NWI4NGMtODZiMC00NmVjLWEzNDctYTBiMjc2YjA3MTU0Iiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTgxNDkwMDY2Mi0xNzQ2Nzk4Mzk0LTk1MjI5ODYtMzc5NzIiLCJwbGF0ZiI6IjUiLCJwdWlkIjoiMTAwMzIwMDBBNUNERDQ2OCIsInJoIjoiMC5BU2dBWDREUUx4XzJlRW1KTnFpZEYzRnp2d0NiOHFHTEFSZEZ0Zl9tVFFuUjN4Z29BQ3MuIiwic2NwIjoiQ2FsZW5kYXJzLlJlYWQgQ29udGFjdHMuUmVhZCBNYWlsLlJlYWQgb3BlbmlkIHByb2ZpbGUgVXNlci5SZWFkIGVtYWlsIiwic3ViIjoiUnJScGpHWHNOSUxBbEg5dXBZLXh3WkRwWm5aM3FURUZZM3FIZ0Z1eWZ3QSIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJOQSIsInRpZCI6IjJmZDA4MDVmLWY2MWYtNDk3OC04OTM2LWE4OWQxNzcxNzNiZiIsInVuaXF1ZV9uYW1lIjoiYW5hbmRoYWJhYnUudnNAc3QtZnJhbmNpcy5vcmciLCJ1cG4iOiJhbmFuZGhhYmFidS52c0BzdC1mcmFuY2lzLm9yZyIsInV0aSI6IjVVX09TZ0hKdUVpdEdzOXBnMUFPQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfc3QiOnsic3ViIjoicmpXYUJZVFVIYWtPQXdtUTlpWjhoV1NiVmUycnZkdXhWcmR6dzVoQ2EwQSJ9LCJ4bXNfdGNkdCI6MTUxNTM2NTA4NX0.Z_h0TCAz__4tC2jGwUjGVNUaaU109gK5T4oM1ljYSk5Iwa285cgcOHUpNaoaiUG93YQOClJKr55BHRoC7wn__qyYlQiLDwaTT44UGyDYqGnjnUgjJXGlaRQ8s38YgiyYfj8t6HaoysJThOqo4FDNJ3myhl41_YKmP3vjr4jNX_QxHhTkYbqFZlGjvh2yTjxc034rjOFwSnOwJ80f5uMcdnjfprNaraOglurgEkqpGewB_NLGNjgwhJbXPGh9aKk98SQIDrSVm8mw3WHSXeYhzEHy66XX3sMJ_xJumLyIwV_OJnXtfJSh23g42O60kaEqWAB7B9Drj6Tv29DO3rhM1w"
    } else {
      this.accessToken = document.cookie && document.cookie.match(new RegExp('token' + '=([^;]+)')) ?
        document.cookie.match(new RegExp('token' + '=([^;]+)'))[1] : '';
    }

    if (environment.name === 'beta') {
      this.userId = '14802';
    } else {
      this.userId = document.cookie && document.cookie.match(new RegExp('userId' + '=([^;]+)')) ?
        document.cookie.match(new RegExp('userId' + '=([^;]+)'))[1] : '';
    }
    this.access_token = "eyJ0eXAiOiJKV1QiLCJub25jZSI6IkpXaW1udzBMbTVJU1NESDVCWGdVekRfWnl5eUdQVjRmQ0ZZVDNJMVlaWFkiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8yZmQwODA1Zi1mNjFmLTQ5NzgtODkzNi1hODlkMTc3MTczYmYvIiwiaWF0IjoxNjE3MTkxOTM5LCJuYmYiOjE2MTcxOTE5MzksImV4cCI6MTYxNzE5NTgzOSwiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsidXJuOnVzZXI6cmVnaXN0ZXJzZWN1cml0eWluZm8iLCJ1cm46bWljcm9zb2Z0OnJlcTEiLCJ1cm46bWljcm9zb2Z0OnJlcTIiLCJ1cm46bWljcm9zb2Z0OnJlcTMiLCJjMSIsImMyIiwiYzMiLCJjNCIsImM1IiwiYzYiLCJjNyIsImM4IiwiYzkiLCJjMTAiLCJjMTEiLCJjMTIiLCJjMTMiLCJjMTQiLCJjMTUiLCJjMTYiLCJjMTciLCJjMTgiLCJjMTkiLCJjMjAiLCJjMjEiLCJjMjIiLCJjMjMiLCJjMjQiLCJjMjUiXSwiYWlvIjoiQVVRQXUvOFRBQUFBczYwY3dxM3BRZmx0d29qUXp1a29oK2xNd2ZqVDh4bmlTRGc1ZFJrY3JIVjdYY1U2SExGTzN4NXRRSm9YMDlnclJOQ0lyMm5VSEdCTWJZcVp0QVdxN3c9PSIsImFtciI6WyJwd2QiLCJtZmEiXSwiYXBwX2Rpc3BsYXluYW1lIjoiQVItQ01TLUFQUC1CRVRBLTAxICIsImFwcGlkIjoiYTFmMjliMDAtMDE4Yi00NTE3LWI1ZmYtZTY0ZDA5ZDFkZjE4IiwiYXBwaWRhY3IiOiIxIiwiZmFtaWx5X25hbWUiOiJWZWVyYXNhbXkiLCJnaXZlbl9uYW1lIjoiQW5hbmRoYWJhYnUiLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiIxMDYuMjIyLjExMi4yMjAiLCJuYW1lIjoiQW5hbmRoYWJhYnUgVmVlcmFzYW15Iiwib2lkIjoiNGU4NWI4NGMtODZiMC00NmVjLWEzNDctYTBiMjc2YjA3MTU0Iiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTgxNDkwMDY2Mi0xNzQ2Nzk4Mzk0LTk1MjI5ODYtMzc5NzIiLCJwbGF0ZiI6IjUiLCJwdWlkIjoiMTAwMzIwMDBBNUNERDQ2OCIsInJoIjoiMC5BU2dBWDREUUx4XzJlRW1KTnFpZEYzRnp2d0NiOHFHTEFSZEZ0Zl9tVFFuUjN4Z29BQ3MuIiwic2NwIjoiQ2FsZW5kYXJzLlJlYWQgQ29udGFjdHMuUmVhZCBNYWlsLlJlYWQgb3BlbmlkIHByb2ZpbGUgVXNlci5SZWFkIGVtYWlsIiwic3ViIjoiUnJScGpHWHNOSUxBbEg5dXBZLXh3WkRwWm5aM3FURUZZM3FIZ0Z1eWZ3QSIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJOQSIsInRpZCI6IjJmZDA4MDVmLWY2MWYtNDk3OC04OTM2LWE4OWQxNzcxNzNiZiIsInVuaXF1ZV9uYW1lIjoiYW5hbmRoYWJhYnUudnNAc3QtZnJhbmNpcy5vcmciLCJ1cG4iOiJhbmFuZGhhYmFidS52c0BzdC1mcmFuY2lzLm9yZyIsInV0aSI6IjVVX09TZ0hKdUVpdEdzOXBnMUFPQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfc3QiOnsic3ViIjoicmpXYUJZVFVIYWtPQXdtUTlpWjhoV1NiVmUycnZkdXhWcmR6dzVoQ2EwQSJ9LCJ4bXNfdGNkdCI6MTUxNTM2NTA4NX0.Z_h0TCAz__4tC2jGwUjGVNUaaU109gK5T4oM1ljYSk5Iwa285cgcOHUpNaoaiUG93YQOClJKr55BHRoC7wn__qyYlQiLDwaTT44UGyDYqGnjnUgjJXGlaRQ8s38YgiyYfj8t6HaoysJThOqo4FDNJ3myhl41_YKmP3vjr4jNX_QxHhTkYbqFZlGjvh2yTjxc034rjOFwSnOwJ80f5uMcdnjfprNaraOglurgEkqpGewB_NLGNjgwhJbXPGh9aKk98SQIDrSVm8mw3WHSXeYhzEHy66XX3sMJ_xJumLyIwV_OJnXtfJSh23g42O60kaEqWAB7B9Drj6Tv29DO3rhM1w";
    this.user_id = '14802';
  }

  intercept(
    req: HttpRequest<any>,
    next: HttpHandler
  ): Observable<HttpEvent<any>> {
    if (
      this._router.url === "/reports/live-prioritized" ||
      this._router.url === "/family/finance_report-live" ||
      this._router.url === "/live-myExports" ||
      this._router.url.includes("/live")
    ) {
      var acc_token =
        "eyJ0eXAiOiJKV1QiLCJub25jZSI6IkFRQUJBQUFBQUFEQ29NcGpKWHJ4VHE5Vkc5dGUtN0ZYTjE0WEdscWNmV1B6UjJPSmJCc0RubGZCektTV05GallVSEFFTlR0UXhqR3U4TFNPQUVYXzFCMDI0SDI2eS1BZkxKOGRjQ291SU13d1hrU2NaRFRyb2lBQSIsImFsZyI6IlJTMjU2IiwieDV0IjoiSEJ4bDltQWU2Z3hhdkNrY29PVTJUSHNETmEwIiwia2lkIjoiSEJ4bDltQWU2Z3hhdkNrY29PVTJUSHNETmEwIn0.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8yZmQwODA1Zi1mNjFmLTQ5NzgtODkzNi1hODlkMTc3MTczYmYvIiwiaWF0IjoxNTU4NjMyNzg5LCJuYmYiOjE1NTg2MzI3ODksImV4cCI6MTU1ODYzNjY4OSwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IjQyWmdZSGhpSTdERE5kdjFTRkxjVk9HRnIwdi9MWml4emxUcjhMZElRZjdjemlDeDBxMEEiLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6IkFSLUNNUy1BUFAtUFJPRC0wMSIsImFwcGlkIjoiYjA1Nzg0NTctNTNjOS00N2IxLWIwNzItNWNkZTAzMWU3N2Q3IiwiYXBwaWRhY3IiOiIxIiwiZmFtaWx5X25hbWUiOiJBIiwiZ2l2ZW5fbmFtZSI6IlJhamVzaCIsImlwYWRkciI6IjY2LjYuMTEwLjE2MiIsIm5hbWUiOiJSYWplc2ggQSIsIm9pZCI6IjBkMTY4MTNiLWZhMTItNGRjYS1iMTBmLTIyOTM2NWMwMjM5MSIsIm9ucHJlbV9zaWQiOiJTLTEtNS0yMS04MTQ5MDA2NjItMTc0Njc5ODM5NC05NTIyOTg2LTMzMjMyIiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDM3RkZFQTc3NkRGN0EiLCJzY3AiOiJDYWxlbmRhcnMuUmVhZCBDb250YWN0cy5SZWFkIE1haWwuUmVhZCBvcGVuaWQgcHJvZmlsZSBVc2VyLlJlYWQgZW1haWwiLCJzaWduaW5fc3RhdGUiOlsiaW5rbm93bm50d2siXSwic3ViIjoiY1FqX3RMeHlJQXQtbkEyMnZkRXduVmhGdmZaMEtvNVAtX1NlZTZGR2JCQSIsInRpZCI6IjJmZDA4MDVmLWY2MWYtNDk3OC04OTM2LWE4OWQxNzcxNzNiZiIsInVuaXF1ZV9uYW1lIjoiUmFqZXNoQUBzdC1mcmFuY2lzLm9yZyIsInVwbiI6IlJhamVzaEFAc3QtZnJhbmNpcy5vcmciLCJ1dGkiOiIxYjlMNklzcURrNkpNMlJDWHlrcEFBIiwidmVyIjoiMS4wIiwid2lkcyI6WyIxOTRhZTRjYi1iMTI2LTQwYjItYmQ1Yi02MDkxYjM4MDk3N2QiLCI1ZDZiNmJiNy1kZTcxLTQ2MjMtYjRhZi05NjM4MGEzNTI1MDkiLCI5Yjg5NWQ5Mi0yY2QzLTQ0YzctOWQwMi1hNmFjMmQ1ZWE1YzMiXSwieG1zX3N0Ijp7InN1YiI6InRKcThpckNuNnpoa0JrS0N1YXpaZTRKVlBOSmpNTzZzT21neXM2Nm9UbGMifSwieG1zX3RjZHQiOjE1MTUzNjUwODV9.XIFSX9AG7f6IUF3psbpwEEYUGEF3R5egTa1RuTDK5yZ8w77DMl4lUPEIivElkvTOMxM-xNF3MwrpaChX6FDn9LS7NYxmYQZlKtI-h-gPEOBPvzql8ERNJXcW-Pl5_6B6l-TnyJG3PtLDFQ-nZAozQ1WeMIV4Q7necPdZrgQ3KgMYoOKn8K1RXl7Df1TOMteWiy1lxcNEFbAyKfj9DL-FPLq4nQOeTLb2bnXF5AK5XyRbckfw9bwdeRgXtnoRGzbFajvv1AwzF-EssMnyo_oklcBOE5oCtqIPyE9TOI6kFDo17t-_Mp2qWlX7RnC2ap52RK2rxGWDWanDT-bHHhRLsw";
      var userID = "4620";
      const authReq = req.clone({
        setHeaders: {
          "Content-Type": "application/json",
          Authorization: `${userID} ${acc_token}`,
        },
      });
      return next.handle(authReq);
    } else {
      const authReq = req.clone({
        setHeaders: {
          "Content-Type": "application/json",
          Authorization: "14802 eyJ0eXAiOiJKV1QiLCJub25jZSI6IkpwcktWVWtmdGVzUVdpeXpEV0huU3hlZE5VTW9xa3lZQlFhcG1QZXg5VGciLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8yZmQwODA1Zi1mNjFmLTQ5NzgtODkzNi1hODlkMTc3MTczYmYvIiwiaWF0IjoxNjI0Mjc4MjI3LCJuYmYiOjE2MjQyNzgyMjcsImV4cCI6MTYyNDI4MjEyNywiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsidXJuOnVzZXI6cmVnaXN0ZXJzZWN1cml0eWluZm8iLCJ1cm46bWljcm9zb2Z0OnJlcTEiLCJ1cm46bWljcm9zb2Z0OnJlcTIiLCJ1cm46bWljcm9zb2Z0OnJlcTMiLCJjMSIsImMyIiwiYzMiLCJjNCIsImM1IiwiYzYiLCJjNyIsImM4IiwiYzkiLCJjMTAiLCJjMTEiLCJjMTIiLCJjMTMiLCJjMTQiLCJjMTUiLCJjMTYiLCJjMTciLCJjMTgiLCJjMTkiLCJjMjAiLCJjMjEiLCJjMjIiLCJjMjMiLCJjMjQiLCJjMjUiXSwiYWlvIjoiQVVRQXUvOFRBQUFBODVNWDkwUFBXZkIzVXJEZmFVT0g2UEVtU01JNmxiMUxyNjZrQUpmV0ExQzhNeGliRGxkVXBHYkFJQkhMa21UMW9Ka3JRWjI3T3JwK29jNWlTZWxiYmc9PSIsImFtciI6WyJwd2QiLCJtZmEiXSwiYXBwX2Rpc3BsYXluYW1lIjoiQVItQ01TLUFQUC1CRVRBLTAxICIsImFwcGlkIjoiYTFmMjliMDAtMDE4Yi00NTE3LWI1ZmYtZTY0ZDA5ZDFkZjE4IiwiYXBwaWRhY3IiOiIxIiwiZmFtaWx5X25hbWUiOiJWZWVyYXNhbXkiLCJnaXZlbl9uYW1lIjoiQW5hbmRoYWJhYnUiLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiIxMDYuMjIyLjEyMC4yMTIiLCJuYW1lIjoiQW5hbmRoYWJhYnUgVmVlcmFzYW15Iiwib2lkIjoiNGU4NWI4NGMtODZiMC00NmVjLWEzNDctYTBiMjc2YjA3MTU0Iiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTgxNDkwMDY2Mi0xNzQ2Nzk4Mzk0LTk1MjI5ODYtMzc5NzIiLCJwbGF0ZiI6IjUiLCJwdWlkIjoiMTAwMzIwMDBBNUNERDQ2OCIsInJoIjoiMC5BU2dBWDREUUx4XzJlRW1KTnFpZEYzRnp2d0NiOHFHTEFSZEZ0Zl9tVFFuUjN4Z29BQ3MuIiwic2NwIjoiQ2FsZW5kYXJzLlJlYWQgQ29udGFjdHMuUmVhZCBNYWlsLlJlYWQgb3BlbmlkIHByb2ZpbGUgVXNlci5SZWFkIGVtYWlsIiwic3ViIjoiUnJScGpHWHNOSUxBbEg5dXBZLXh3WkRwWm5aM3FURUZZM3FIZ0Z1eWZ3QSIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJOQSIsInRpZCI6IjJmZDA4MDVmLWY2MWYtNDk3OC04OTM2LWE4OWQxNzcxNzNiZiIsInVuaXF1ZV9uYW1lIjoiYW5hbmRoYWJhYnUudnNAc3QtZnJhbmNpcy5vcmciLCJ1cG4iOiJhbmFuZGhhYmFidS52c0BzdC1mcmFuY2lzLm9yZyIsInV0aSI6IlZWM0Z2NzhFZTBldFlQYURmTjI1QUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfc3QiOnsic3ViIjoicmpXYUJZVFVIYWtPQXdtUTlpWjhoV1NiVmUycnZkdXhWcmR6dzVoQ2EwQSJ9LCJ4bXNfdGNkdCI6MTUxNTM2NTA4NX0.UK0PuBoH3T9BMtcvFlTaCiKOYDnlNkib1UHAprmF9Acwp65m4SbLy4Ka8W84GehghEhitc75TFIqtHyWRJV1GIwzo_026dDETM77-fxtDxJWivdpkJpSkwX1FnYURAf15Q4AuLqFK1KBeGgxPfd4LIxRUQwPoroxVNBxmKJFYS9llCqIUhWm9ltF_YJ7X_5lLgBWIDehX-FZz1vdcD_FVBvAZf2eohGsP5q30aaa994s77SaXtOfVXOZvlny_dAr44iiCmtOiRgoLJl3GSMgN9VGuhVm8e68UJBSPYP81jL4OojxvgK0cc4U49VTX_fdkRCzUZOJPWqbQZslGNG8PQ",
        },
      });
      return next.handle(authReq);
    }
  }
}
